import{B as g,s as ue,a as re,b as de,c as ce,d as me,e as ve,f as pe,g as fe,h as ye,i as be}from"./BaseServices-C_UKSvfQ.js";import{s as ge}from"./index-C6PKTdAS.js";import{s as _e}from"./index-DvlnKz5W.js";import{s as he}from"./axios-D69jWvol.js";import{I as ke}from"./IncomeCategoryService-DUQtb-ng.js";import{G as s,H as xe,K as Ie,o as m,j as v,k as i,x as l,v as n,F as De,A as V,t as L,q as _,L as we}from"./index-C0siwK5o.js";const h="https://be-keuangan-7630cbd16970.herokuapp.com/api/incomes",k={getData:async()=>await g.getData(h),create:async c=>await g.create(c,h),update:async(c,u)=>await g.update(c,u,h),delete:async c=>await g.delete(c,h),bulkDelete:async c=>await g.bulkDelete(c,`${h}/bulk-delete`),import:async c=>await g.import(c,`${h}/import`)},Ce={class:"card flex items-center justify-between py-3"},Se=i("h2",{class:"font-semibold text-2xl"},"Income",-1),Ve={class:"card"},$e={class:"flex flex-wrap gap-2 items-center justify-between"},Ue=i("h4",{class:"m-0"},"Manage Incomes",-1),Le=i("i",{class:"pi pi-search"},null,-1),Ne={class:"flex flex-col gap-6"},Pe=i("label",{for:"date",class:"block font-bold mb-3"},"Date",-1),Fe={key:0,class:"text-red-500"},qe=i("label",{for:"name",class:"block font-bold mb-3"},"Description",-1),Be={key:0,class:"text-red-500"},Me=i("label",{for:"category",class:"block font-bold mb-3"},"Category",-1),Te={key:0,class:"text-red-500"},Ae=i("label",{for:"price",class:"block font-bold mb-3"},"Amount",-1),Re={key:0,class:"text-red-500"},je={class:"flex items-center gap-4"},Ee=i("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),He={key:0},Ke={class:"flex items-center gap-4"},Oe=i("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),Ye={key:0},Ze={__name:"Income",setup(c){const u=s(),$=s(),w=s(!1),N=async()=>{try{w.value=!0,u.value=await k.getData()}catch(a){console.error(a)}finally{w.value=!1}},B=async()=>{try{w.value=!0,$.value=await ke.getData().then(a=>a.map(t=>({label:t.name,value:t})))}catch(a){console.error(a)}finally{w.value=!1}};xe(()=>{B(),N()});const x=Ie(),P=s(),p=s(!1),C=s(!1),I=s(!1),D=s(!1),e=s({}),F=s(null),f=s(),U=s({global:{value:null,matchMode:we.CONTAINS}}),d=s(!1);function M(a){F.value=a.files[0]}function T(a){if(a)return a.toLocaleString("id-ID",{style:"currency",currency:"IDR"})}function A(a){if(a)return new Date(a).toLocaleDateString("en-US",{month:"long",day:"2-digit",year:"numeric"})}function R(){e.value={},d.value=!1,p.value=!0}function j(){p.value=!1,d.value=!1}async function E(){var a;d.value=!0,(a=e==null?void 0:e.value.description)!=null&&a.trim()&&(e!=null&&e.value.amount)&&(e.value.id?(await k.update(e.value.id,{date:e.value.date,description:e.value.description,amount:e.value.amount,category_id:e.value.category.value.id}),u.value[Y(e.value.id)]={id:e.value.id,date:e.value.date,description:e.value.description,amount:e.value.amount,category:{name:e.value.category.value.name}},x.add({severity:"success",summary:"Successful",detail:"Income Updated",life:3e3})):(await k.create({date:e.value.date,description:e.value.description,amount:e.value.amount,category_id:e.value.category.value.id}),u.value.unshift({date:e.value.date,description:e.value.description,amount:e.value.amount,category:{name:e.value.category.value.name}}),x.add({severity:"success",summary:"Successful",detail:"Income Created",life:3e3})),p.value=!1,e.value={})}function H(a){e.value={id:a.id,date:new Date(a.date),description:a.description,amount:a.amount,category:$.value.find(t=>t.value.id===a.category.id)},p.value=!0}function K(a){e.value=a,I.value=!0}function O(){k.delete(e.value.id),u.value=u.value.filter(a=>a.id!==e.value.id),I.value=!1,e.value={},x.add({severity:"success",summary:"Successful",detail:"Income Deleted",life:3e3})}function Y(a){let t=-1;for(let y=0;y<u.value.length;y++)if(u.value[y].id===a){t=y;break}return t}function z(){P.value.exportCSV()}function G(){k.import({file:F.value}).then(()=>{N()}).catch(a=>{console.error(a)}),C.value=!1,x.add({severity:"info",summary:"Success",detail:"File Uploaded",life:3e3})}function J(){D.value=!0}function Q(){let a=f.value.map(t=>t.id);k.bulkDelete({ids:a}),u.value=u.value.filter(t=>!a.includes(t.id)),D.value=!1,f.value=null,x.add({severity:"success",summary:"Successful",detail:"Incomes Deleted",life:3e3})}const W=s([{label:"Dashboard",to:"/"},{label:"Data"},{label:"Income"}]),X=s({icon:"pi pi-home",to:"/"});return(a,t)=>{const y=ue,r=he,Z=re,ee=me,q=_e,te=ve,b=pe,ae=de,le=ge,oe=fe,ie=ye,S=ce,ne=be;return m(),v(De,null,[i("div",Ce,[Se,l(y,{home:X.value,model:W.value},null,8,["home","model"])]),i("div",null,[i("div",Ve,[l(Z,{class:"mb-6"},{start:n(()=>[l(r,{label:"New",icon:"pi pi-plus",severity:"secondary",class:"mr-2",onClick:R}),l(r,{label:"Delete",icon:"pi pi-trash",severity:"secondary",onClick:J,disabled:!f.value||!f.value.length},null,8,["disabled"])]),end:n(()=>[l(r,{label:"Import",icon:"pi pi-download",severity:"secondary mx-2",onClick:t[0]||(t[0]=o=>C.value=!0)}),l(r,{label:"Export",icon:"pi pi-upload",severity:"secondary",onClick:t[1]||(t[1]=o=>z(o))})]),_:1}),l(ae,{ref_key:"dt",ref:P,selection:f.value,"onUpdate:selection":t[3]||(t[3]=o=>f.value=o),value:u.value,dataKey:"id",paginator:!0,rows:10,filters:U.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} incomes"},{header:n(()=>[i("div",$e,[Ue,l(te,null,{default:n(()=>[l(ee,null,{default:n(()=>[Le]),_:1}),l(q,{modelValue:U.value.global.value,"onUpdate:modelValue":t[2]||(t[2]=o=>U.value.global.value=o),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),default:n(()=>[l(b,{selectionMode:"multiple",style:{width:"3rem"},exportable:!1}),l(b,{field:"date",header:"Date",sortable:""},{body:n(o=>[V(L(A(o.data.date)),1)]),_:1}),l(b,{field:"description",header:"Description",sortable:""}),l(b,{field:"category.name",header:"Category",sortable:""}),l(b,{field:"amount",header:"Amount",sortable:""},{body:n(o=>[V(L(T(o.data.amount)),1)]),_:1}),l(b,{exportable:!1,style:{"min-width":"12rem"}},{body:n(o=>[l(r,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:se=>H(o.data)},null,8,["onClick"]),l(r,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:se=>K(o.data)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","filters"])]),l(S,{visible:p.value,"onUpdate:visible":t[8]||(t[8]=o=>p.value=o),style:{width:"450px"},header:"Income Details",modal:!0},{footer:n(()=>[l(r,{label:"Cancel",icon:"pi pi-times",text:"",onClick:j}),l(r,{label:"Save",icon:"pi pi-check",onClick:E})]),default:n(()=>[i("div",Ne,[i("div",null,[Pe,l(le,{id:"date",modelValue:e.value.date,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.date=o),invalid:d.value&&!e.value.date,required:"true",showIcon:"",fluid:""},null,8,["modelValue","invalid"]),d.value&&!e.value.date?(m(),v("small",Fe,"date is required.")):_("",!0)]),i("div",null,[qe,l(q,{id:"description",modelValue:e.value.description,"onUpdate:modelValue":t[5]||(t[5]=o=>e.value.description=o),modelModifiers:{trim:!0},required:"true",autofocus:"",invalid:d.value&&!e.value.description,fluid:""},null,8,["modelValue","invalid"]),d.value&&!e.value.description?(m(),v("small",Be,"description is required.")):_("",!0)]),i("div",null,[Me,l(oe,{id:"category",modelValue:e.value.category,"onUpdate:modelValue":t[6]||(t[6]=o=>e.value.category=o),options:$.value,optionLabel:"label",placeholder:"Select a Category",required:"true",invalid:d.value&&!e.value.category,fluid:""},null,8,["modelValue","options","invalid"]),d.value&&!e.value.category?(m(),v("small",Te,"category is required.")):_("",!0)]),i("div",null,[Ae,l(ie,{id:"amount",modelValue:e.value.amount,"onUpdate:modelValue":t[7]||(t[7]=o=>e.value.amount=o),modelModifiers:{trim:!0},required:"true",invalid:d.value&&!e.value.amount,fluid:""},null,8,["modelValue","invalid"]),d.value&&!e.value.amount?(m(),v("small",Re,"amount is required.")):_("",!0)])])]),_:1},8,["visible"]),l(S,{visible:C.value,"onUpdate:visible":t[9]||(t[9]=o=>C.value=o),style:{width:"450px"},header:"Import Income",modal:!0},{default:n(()=>[l(ne,{name:"file",onUploader:G,onSelect:M,maxFileSize:1e6,customUpload:""})]),_:1},8,["visible"]),l(S,{visible:I.value,"onUpdate:visible":t[11]||(t[11]=o=>I.value=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:n(()=>[l(r,{label:"No",icon:"pi pi-times",text:"",onClick:t[10]||(t[10]=o=>I.value=!1)}),l(r,{label:"Yes",icon:"pi pi-check",onClick:O})]),default:n(()=>[i("div",je,[Ee,e.value?(m(),v("span",He,[V("Are you sure you want to delete "),i("b",null,L(e.value.description),1),V("?")])):_("",!0)])]),_:1},8,["visible"]),l(S,{visible:D.value,"onUpdate:visible":t[13]||(t[13]=o=>D.value=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:n(()=>[l(r,{label:"No",icon:"pi pi-times",text:"",onClick:t[12]||(t[12]=o=>D.value=!1)}),l(r,{label:"Yes",icon:"pi pi-check",text:"",onClick:Q})]),default:n(()=>[i("div",Ke,[Oe,e.value?(m(),v("span",Ye,"Are you sure you want to delete the selected Incomes?")):_("",!0)])]),_:1},8,["visible"])])],64)}}};export{Ze as default};
