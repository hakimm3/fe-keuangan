import{B as g,s as ue,a as re,b as de,c as ce,d as pe,e as ve,f as me,g as fe,h as ye,i as be}from"./BaseServices-BULPUDtE.js";import{s as ge}from"./index-BZSBA1xM.js";import{s as xe}from"./index-6pvBhEup.js";import{s as _e}from"./axios-Ds2gSxib.js";import{E as he}from"./ExpenseCategoryService-B-sgeIr_.js";import{G as n,H as ke,K as De,o as p,j as v,k as i,x as l,v as s,F as we,A as V,t as I,q as x,L as Ce}from"./index-DEkeYv1g.js";const _="https://be-keuangan-7630cbd16970.herokuapp.com/api/spendings",h={getData:async()=>await g.getData(_),create:async c=>await g.create(c,_),update:async(c,u)=>await g.update(c,u,_),delete:async c=>await g.delete(c,_),bulkDelete:async c=>await g.bulkDelete(c,`${_}/bulk-delete`),import:async c=>await g.import(c,`${_}/import`)},Ee={class:"card flex items-center justify-between py-3"},Se=i("h2",{class:"font-semibold text-2xl"},"Expense",-1),Ve={class:"card"},$e={class:"flex flex-wrap gap-2 items-center justify-between"},Ue=i("h4",{class:"m-0"},"Manage Expenses",-1),Ie=i("i",{class:"pi pi-search"},null,-1),Le={class:"flex flex-col gap-6"},Ne=i("label",{for:"date",class:"block font-bold mb-3"},"Date",-1),Pe={key:0,class:"text-red-500"},Fe=i("label",{for:"name",class:"block font-bold mb-3"},"Description",-1),qe={key:0,class:"text-red-500"},Be=i("label",{for:"category",class:"block font-bold mb-3"},"Category",-1),Me={key:0,class:"text-red-500"},Te=i("label",{for:"price",class:"block font-bold mb-3"},"Amount",-1),Ae={key:0,class:"text-red-500"},Re={class:"flex items-center gap-4"},je=i("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),He={key:0},Ke={class:"flex items-center gap-4"},Oe=i("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),Ye={key:0},Ze={__name:"Expense",setup(c){const u=n(),$=n(),C=n(!1),L=async()=>{try{C.value=!0,u.value=await h.getData()}catch(a){console.error(a)}finally{C.value=!1}},q=async()=>{try{C.value=!0,$.value=await he.getData().then(a=>a.map(t=>({label:t.name,value:t})))}catch(a){console.error(a)}finally{C.value=!1}};ke(()=>{q(),L()});const k=De(),N=n(),m=n(!1),E=n(!1),D=n(!1),w=n(!1),e=n({}),P=n(null),f=n(),U=n({global:{value:null,matchMode:Ce.CONTAINS}}),d=n(!1);function B(a){P.value=a.files[0]}function M(a){if(a)return a.toLocaleString("id-ID",{style:"currency",currency:"IDR"})}function T(a){if(a)return new Date(a).toLocaleDateString("en-US",{month:"long",day:"2-digit",year:"numeric"})}function A(){e.value={},d.value=!1,m.value=!0}function R(){m.value=!1,d.value=!1}async function j(){var a;d.value=!0,(a=e==null?void 0:e.value.description)!=null&&a.trim()&&(e!=null&&e.value.amount)&&(e.value.id?(await h.update(e.value.id,{date:e.value.date,description:e.value.description,amount:e.value.amount,category_id:e.value.category.value.id}),u.value[Y(e.value.id)]={id:e.value.id,date:e.value.date,description:e.value.description,amount:e.value.amount,category:{name:e.value.category.value.name}},k.add({severity:"success",summary:"Successful",detail:"Expense Updated",life:3e3})):(await h.create({date:e.value.date,description:e.value.description,amount:e.value.amount,category_id:e.value.category.value.id}),u.value.unshift({date:e.value.date,description:e.value.description,amount:e.value.amount,category:{name:e.value.category.value.name}}),k.add({severity:"success",summary:"Successful",detail:"Expense Created",life:3e3})),m.value=!1,e.value={})}function H(a){e.value={id:a.id,date:new Date(a.date),description:a.description,amount:a.amount,category:$.value.find(t=>t.value.id===a.category.id)},m.value=!0}function K(a){e.value=a,D.value=!0}function O(){h.delete(e.value.id),u.value=u.value.filter(a=>a.id!==e.value.id),D.value=!1,e.value={},k.add({severity:"success",summary:"Successful",detail:"Expense Deleted",life:3e3})}function Y(a){let t=-1;for(let y=0;y<u.value.length;y++)if(u.value[y].id===a){t=y;break}return t}function z(){N.value.exportCSV()}function G(){h.import({file:P.value}).then(()=>{L()}).catch(a=>{console.error(a)}),E.value=!1,k.add({severity:"info",summary:"Success",detail:"File Uploaded",life:3e3})}function J(){w.value=!0}function Q(){let a=f.value.map(t=>t.id);h.bulkDelete({ids:a}),u.value=u.value.filter(t=>!a.includes(t.id)),w.value=!1,f.value=null,k.add({severity:"success",summary:"Successful",detail:"Expenses Deleted",life:3e3})}const W=n([{label:"Dashboard",to:"/"},{label:"Data"},{label:"Expense"}]),X=n({icon:"pi pi-home",to:"/"});return(a,t)=>{const y=ue,r=_e,Z=re,ee=pe,F=xe,te=ve,b=me,ae=de,le=ge,oe=fe,ie=ye,S=ce,se=be;return p(),v(we,null,[i("div",Ee,[Se,l(y,{home:X.value,model:W.value},null,8,["home","model"])]),i("div",null,[i("div",Ve,[l(Z,{class:"mb-6"},{start:s(()=>[l(r,{label:"New",icon:"pi pi-plus",severity:"secondary",class:"mr-2",onClick:A}),l(r,{label:"Delete",icon:"pi pi-trash",severity:"secondary",onClick:J,disabled:!f.value||!f.value.length},null,8,["disabled"])]),end:s(()=>[l(r,{label:"Import",icon:"pi pi-download",severity:"secondary mx-2",onClick:t[0]||(t[0]=o=>E.value=!0)}),l(r,{label:"Export",icon:"pi pi-upload",severity:"secondary",onClick:t[1]||(t[1]=o=>z(o))})]),_:1}),l(ae,{ref_key:"dt",ref:N,selection:f.value,"onUpdate:selection":t[3]||(t[3]=o=>f.value=o),value:u.value,dataKey:"id",paginator:!0,rows:10,filters:U.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} expenses"},{header:s(()=>[i("div",$e,[Ue,l(te,null,{default:s(()=>[l(ee,null,{default:s(()=>[Ie]),_:1}),l(F,{modelValue:U.value.global.value,"onUpdate:modelValue":t[2]||(t[2]=o=>U.value.global.value=o),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),default:s(()=>[l(b,{selectionMode:"multiple",style:{width:"3rem"},exportable:!1}),l(b,{field:"date",header:"Date",sortable:""},{body:s(o=>[V(I(T(o.data.date)),1)]),_:1}),l(b,{field:"description",header:"Description",sortable:""}),l(b,{field:"category.name",header:"Category",sortable:""}),l(b,{field:"amount",header:"Amount",sortable:""},{body:s(o=>[V(I(M(o.data.amount)),1)]),_:1}),l(b,{exportable:!1,style:{"min-width":"12rem"}},{body:s(o=>[l(r,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:ne=>H(o.data)},null,8,["onClick"]),l(r,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:ne=>K(o.data)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","filters"])]),l(S,{visible:m.value,"onUpdate:visible":t[8]||(t[8]=o=>m.value=o),style:{width:"450px"},header:"Expense Details",modal:!0},{footer:s(()=>[l(r,{label:"Cancel",icon:"pi pi-times",text:"",onClick:R}),l(r,{label:"Save",icon:"pi pi-check",onClick:j})]),default:s(()=>[i("div",Le,[i("div",null,[Ne,l(le,{id:"date",modelValue:e.value.date,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.date=o),invalid:d.value&&!e.value.date,required:"true",showIcon:"",fluid:""},null,8,["modelValue","invalid"]),d.value&&!e.value.date?(p(),v("small",Pe,"date is required.")):x("",!0)]),i("div",null,[Fe,l(F,{id:"description",modelValue:e.value.description,"onUpdate:modelValue":t[5]||(t[5]=o=>e.value.description=o),modelModifiers:{trim:!0},required:"true",autofocus:"",invalid:d.value&&!e.value.description,fluid:""},null,8,["modelValue","invalid"]),d.value&&!e.value.description?(p(),v("small",qe,"description is required.")):x("",!0)]),i("div",null,[Be,l(oe,{id:"category",modelValue:e.value.category,"onUpdate:modelValue":t[6]||(t[6]=o=>e.value.category=o),options:$.value,optionLabel:"label",placeholder:"Select a Category",required:"true",invalid:d.value&&!e.value.category,fluid:""},null,8,["modelValue","options","invalid"]),d.value&&!e.value.category?(p(),v("small",Me,"category is required.")):x("",!0)]),i("div",null,[Te,l(ie,{id:"amount",modelValue:e.value.amount,"onUpdate:modelValue":t[7]||(t[7]=o=>e.value.amount=o),modelModifiers:{trim:!0},required:"true",invalid:d.value&&!e.value.amount,fluid:""},null,8,["modelValue","invalid"]),d.value&&!e.value.amount?(p(),v("small",Ae,"amount is required.")):x("",!0)])])]),_:1},8,["visible"]),l(S,{visible:E.value,"onUpdate:visible":t[9]||(t[9]=o=>E.value=o),style:{width:"450px"},header:"Import Expense",modal:!0},{default:s(()=>[l(se,{name:"file",onUploader:G,onSelect:B,maxFileSize:1e6,customUpload:""})]),_:1},8,["visible"]),l(S,{visible:D.value,"onUpdate:visible":t[11]||(t[11]=o=>D.value=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:s(()=>[l(r,{label:"No",icon:"pi pi-times",text:"",onClick:t[10]||(t[10]=o=>D.value=!1)}),l(r,{label:"Yes",icon:"pi pi-check",onClick:O})]),default:s(()=>[i("div",Re,[je,e.value?(p(),v("span",He,[V("Are you sure you want to delete "),i("b",null,I(e.value.description),1),V("?")])):x("",!0)])]),_:1},8,["visible"]),l(S,{visible:w.value,"onUpdate:visible":t[13]||(t[13]=o=>w.value=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:s(()=>[l(r,{label:"No",icon:"pi pi-times",text:"",onClick:t[12]||(t[12]=o=>w.value=!1)}),l(r,{label:"Yes",icon:"pi pi-check",text:"",onClick:Q})]),default:s(()=>[i("div",Ke,[Oe,e.value?(p(),v("span",Ye,"Are you sure you want to delete the selected expenses?")):x("",!0)])]),_:1},8,["visible"])])],64)}}};export{Ze as default};
