import{s as G}from"./index-CmCuRXjW.js";import{s as J,a as Q,b as X,c as Z,d as ee,e as le}from"./BaseServices-C7MaePp3.js";import{s as te,a as ae}from"./index-BFNgdO1s.js";import{W as b}from"./WalletService-DFNdWtQt.js";import{b as n,d as oe,f as se,o as g,c as h,a as s,e as a,g as i,F as ie,h as w,t as I,j as D,k as ne}from"./index-CqvKQK5V.js";import"./axios-BimPEqV4.js";const ue={class:"card flex items-center justify-between py-3"},re=s("h2",{class:"font-semibold text-2xl"},"Wallets",-1),de={class:"card"},ce={class:"flex flex-wrap gap-2 items-center justify-between"},pe=s("h4",{class:"m-0"},"Manage Wallets",-1),me=s("i",{class:"pi pi-search"},null,-1),fe={class:"flex flex-col gap-6"},ve=s("label",{for:"name",class:"block font-bold mb-3"},"Name",-1),_e={key:0,class:"text-red-500"},be=s("label",{for:"topup_fee",class:"block font-bold mb-3"},"Top Up Fee",-1),ye={class:"flex items-center gap-4"},ge=s("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),he={key:0},xe={class:"flex items-center gap-4"},ke=s("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),Ce={key:0},$e={__name:"Wallet",setup(we){const t=n(),r=n(),N=n(!1),W=async()=>{try{N.value=!0,r.value=await b.getData()}catch(e){console.error(e)}finally{N.value=!1}};oe(()=>{W()});const m=se(),S=n(),c=n(!1),f=n(!1),v=n(!1),d=n(),x=n({global:{value:null,matchMode:ne.CONTAINS}}),_=n(!1);function $(e){if(!isNaN(e))return e.toLocaleString("id-ID",{style:"currency",currency:"IDR"})}function P(){t.value={},_.value=!1,c.value=!0}function T(){c.value=!1,_.value=!1}function V(e){m.add({severity:"error",summary:"Error",detail:e,life:3e3})}async function M(){if(_.value=!0,t!=null&&t.value.name){if(t.value.id){const e=await b.update(t.value.id,{name:t.value.name,topup_fee:t.value.topup_fee});if(e.status===422){V(e.data.message);return}r.value[B(t.value.id)]=t.value,m.add({severity:"success",summary:"Successful",detail:"Wallets Updated",life:3e3})}else{const e=await b.create({name:t.value.name,topup_fee:t.value.topup_fee});if(e.status===422){V(e.data.message);return}r.value.unshift(e.data),m.add({severity:"success",summary:"Successful",detail:"Wallets Created",life:3e3})}c.value=!1,t.value={}}}function U(e){t.value={id:e.id,name:e.name,topup_fee:e.topup_fee},c.value=!0}function L(e){t.value=e,f.value=!0}function F(){b.delete(t.value.id),r.value=r.value.filter(e=>e.id!==t.value.id),f.value=!1,t.value={},m.add({severity:"success",summary:"Successful",detail:"Wallet Deleted",life:3e3})}function B(e){let l=-1;for(let p=0;p<r.value.length;p++)if(r.value[p].id===e){l=p;break}return l}function R(){S.value.exportCSV()}function E(){v.value=!0}function j(){let e=d.value.map(l=>l.id);b.bulkDelete({ids:e}),r.value=r.value.filter(l=>!e.includes(l.id)),v.value=!1,d.value=null,m.add({severity:"success",summary:"Successful",detail:"Income Deleted",life:3e3})}const q=n([{label:"Dashboard",to:"/"},{label:"Master Data"},{label:"Wallets"}]),A=n({icon:"pi pi-home",to:"/"});return(e,l)=>{const p=J,u=te,O=Q,Y=Z,k=ae,H=ee,y=le,K=X,C=G;return g(),h(ie,null,[s("div",ue,[re,a(p,{home:A.value,model:q.value},null,8,["home","model"])]),s("div",null,[s("div",de,[a(O,{class:"mb-6"},{start:i(()=>[a(u,{label:"New",icon:"pi pi-plus",severity:"secondary",class:"mr-2",onClick:P}),a(u,{label:"Delete",icon:"pi pi-trash",severity:"secondary",onClick:E,disabled:!d.value||!d.value.length},null,8,["disabled"])]),end:i(()=>[a(u,{label:"Export",icon:"pi pi-upload",severity:"secondary",onClick:l[0]||(l[0]=o=>R(o))})]),_:1}),a(K,{ref_key:"dt",ref:S,selection:d.value,"onUpdate:selection":l[2]||(l[2]=o=>d.value=o),value:r.value,dataKey:"id",paginator:!0,rows:10,filters:x.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} wallets"},{header:i(()=>[s("div",ce,[pe,a(H,null,{default:i(()=>[a(Y,null,{default:i(()=>[me]),_:1}),a(k,{modelValue:x.value.global.value,"onUpdate:modelValue":l[1]||(l[1]=o=>x.value.global.value=o),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),default:i(()=>[a(y,{selectionMode:"multiple",style:{width:"3rem"},exportable:!1}),a(y,{field:"name",header:"Name",sortable:""}),a(y,{field:"topup_fee",header:"Topup Fee",sortable:""},{body:i(o=>[w(I($(o.data.topup_fee)),1)]),_:1}),a(y,{exportable:!1},{body:i(o=>[a(u,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:z=>U(o.data)},null,8,["onClick"]),a(u,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:z=>L(o.data)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","filters"])]),a(C,{visible:c.value,"onUpdate:visible":l[5]||(l[5]=o=>c.value=o),style:{width:"450px"},header:"Income Category Details",modal:!0},{footer:i(()=>[a(u,{label:"Cancel",icon:"pi pi-times",text:"",onClick:T}),a(u,{label:"Save",icon:"pi pi-check",onClick:M})]),default:i(()=>[s("div",fe,[s("div",null,[ve,a(k,{id:"name",modelValue:t.value.name,"onUpdate:modelValue":l[3]||(l[3]=o=>t.value.name=o),modelModifiers:{trim:!0},required:"true",autofocus:"",invalid:_.value&&!t.value.name,fluid:""},null,8,["modelValue","invalid"]),_.value&&!t.value.name?(g(),h("small",_e,"name is required.")):D("",!0)]),s("div",null,[be,a(k,{id:"topup_fee",modelValue:t.value.topup_fee,"onUpdate:modelValue":l[4]||(l[4]=o=>t.value.topup_fee=o),modelModifiers:{trim:!0},required:"true",autofocus:"",fluid:""},null,8,["modelValue"])])])]),_:1},8,["visible"]),a(C,{visible:f.value,"onUpdate:visible":l[7]||(l[7]=o=>f.value=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:i(()=>[a(u,{label:"No",icon:"pi pi-times",text:"",onClick:l[6]||(l[6]=o=>f.value=!1)}),a(u,{label:"Yes",icon:"pi pi-check",onClick:F})]),default:i(()=>[s("div",ye,[ge,t.value?(g(),h("span",he,[w("Are you sure you want to delete "),s("b",null,I(t.value.name),1),w("?")])):D("",!0)])]),_:1},8,["visible"]),a(C,{visible:v.value,"onUpdate:visible":l[9]||(l[9]=o=>v.value=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:i(()=>[a(u,{label:"No",icon:"pi pi-times",text:"",onClick:l[8]||(l[8]=o=>v.value=!1)}),a(u,{label:"Yes",icon:"pi pi-check",text:"",onClick:j})]),default:i(()=>[s("div",xe,[ke,d.value?(g(),h("span",Ce,"Are you sure you want to delete the selected wallets?")):D("",!0)])]),_:1},8,["visible"])])],64)}}};export{$e as default};
