<script setup>
import FloatingConfigurator from '@/components/FloatingConfigurator.vue';
import router from '@/router';
import { authStore } from '@/store/auth';
import { computed, ref } from 'vue';

const auth = authStore();

function handleSignUp() {
    auth.register(name.value, email.value, password.value);
}

function handleLogin() {
    router.push('/auth/login');
}

const name = ref('');
const email = ref('');
const password = ref('');
const confirmPassword = ref('');

const passwordMismatch = computed(() => {
    return confirmPassword.value && password.value !== confirmPassword.value;
});

const isFormInvalid = computed(() => {
    return !name.value || !email.value || !password.value || !confirmPassword.value || passwordMismatch.value;
});
</script>

<template>
    <FloatingConfigurator />
    <div class="bg-surface-50 dark:bg-surface-950 flex items-center justify-center min-h-screen min-w-[100vw] overflow-hidden">
        <div class="flex flex-col items-center justify-center">
            <div style="border-radius: 56px; padding: 0.3rem; background: linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)">
                <div class="w-full bg-surface-0 dark:bg-surface-900 py-20 px-8 sm:px-20" style="border-radius: 53px">
                    <div class="text-center mb-8">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 375 374.999991" class="mb-8 w-20 shrink-0 mx-auto">
                            <defs>
                                <g />
                                <clipPath id="c3101de51e"><path d="M 220 3.398438 L 265 3.398438 L 265 169 L 220 169 Z M 220 3.398438 " clip-rule="nonzero" /></clipPath>
                                <clipPath id="d926d8b324"><path d="M 47 40 L 331.910156 40 L 331.910156 261 L 47 261 Z M 47 40 " clip-rule="nonzero" /></clipPath>
                            </defs>
                            <path
                                fill="var(--primary-color)"
                                d="M 104.847656 79.902344 C 78.417969 93.117188 59.734375 112.371094 61.101562 136.46875 L 61.101562 207.449219 C 62.867188 210.238281 65.03125 212.574219 66.96875 214.339844 C 76.992188 223.171875 91.0625 225.394531 104.847656 224.9375 Z M 104.847656 79.902344 "
                                fill-opacity="1"
                                fill-rule="nonzero"
                            />
                            <path
                                fill="var(--primary-color)"
                                d="M 157.882812 62.925781 C 142.902344 65.433594 127.75 69.820312 114.132812 75.574219 L 114.132812 224.253906 C 119.433594 223.683594 124.730469 222.660156 129.515625 221.746094 C 139.199219 219.582031 148.597656 216.050781 157.882812 211.890625 Z M 157.882812 62.925781 "
                                fill-opacity="1"
                                fill-rule="nonzero"
                            />
                            <path
                                fill="var(--primary-color)"
                                d="M 210.917969 46.179688 C 197.703125 53.527344 182.890625 59.394531 167.167969 61.558594 L 167.167969 206.992188 C 178.789062 200.839844 189.671875 193.777344 199.640625 186.144531 C 203.34375 183.351562 207.160156 180.277344 210.863281 177.027344 L 210.863281 46.179688 Z M 210.917969 46.179688 "
                                fill-opacity="1"
                                fill-rule="nonzero"
                            />
                            <g clip-path="url(#c3101de51e)">
                                <path
                                    fill="var(--primary-color)"
                                    d="M 264.125 120.0625 C 264.125 81.269531 264.125 42.363281 264.125 3.398438 C 264.125 3.398438 246.351562 23.675781 220.203125 40.425781 L 220.203125 168.941406 C 233.25 157.320312 245.441406 144.273438 256.035156 130.714844 C 258.371094 127.808594 261.164062 124.277344 264.125 120.0625 Z M 264.125 120.0625 "
                                    fill-opacity="1"
                                    fill-rule="nonzero"
                                />
                            </g>
                            <g clip-path="url(#d926d8b324)">
                                <path
                                    fill="var(--primary-color)"
                                    d="M 47.996094 198.617188 C 47.996094 198.617188 55.515625 247.097656 131.394531 229.949219 C 207.046875 213.03125 282.980469 122.285156 290.5 88.046875 L 269.765625 84.914062 L 318.699219 40.480469 L 332.710938 99.214844 L 315.222656 93.515625 C 260.421875 240.773438 41.5625 324.683594 47.996094 198.617188 Z M 47.996094 198.617188 "
                                    fill-opacity="1"
                                    fill-rule="nonzero"
                                />
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(107.938645, 325.8768)">
                                    <g>
                                        <path
                                            d="M 22.921875 -33.34375 L 22.921875 -23.984375 C 22.921875 -23.035156 22.613281 -22.238281 22 -21.59375 C 21.394531 -20.957031 20.632812 -20.550781 19.71875 -20.375 L 19.71875 -20.28125 C 20.632812 -20.144531 21.394531 -19.742188 22 -19.078125 C 22.613281 -18.421875 22.921875 -17.617188 22.921875 -16.671875 L 22.921875 -7.3125 C 22.921875 -4.945312 22.289062 -3.132812 21.03125 -1.875 C 19.78125 -0.625 17.953125 0 15.546875 0 L 3.359375 0 C 2.816406 0 2.546875 -0.269531 2.546875 -0.8125 L 2.546875 -39.84375 C 2.546875 -40.382812 2.816406 -40.65625 3.359375 -40.65625 L 15.546875 -40.65625 C 17.953125 -40.65625 19.78125 -40.035156 21.03125 -38.796875 C 22.289062 -37.566406 22.921875 -35.75 22.921875 -33.34375 Z M 16.15625 -25.671875 L 16.15625 -31.921875 C 16.15625 -33.273438 15.476562 -33.953125 14.125 -33.953125 L 9.5 -33.953125 L 9.5 -23.6875 L 14.125 -23.6875 C 15.476562 -23.6875 16.15625 -24.347656 16.15625 -25.671875 Z M 16.15625 -8.75 L 16.15625 -14.9375 C 16.15625 -16.300781 15.476562 -16.984375 14.125 -16.984375 L 9.5 -16.984375 L 9.5 -6.703125 L 14.125 -6.703125 C 15.476562 -6.703125 16.15625 -7.382812 16.15625 -8.75 Z M 16.15625 -8.75 "
                                        />
                                    </g>
                                </g>
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(134.91737, 325.8768)">
                                    <g>
                                        <path
                                            d="M 17.1875 -40.65625 L 21.859375 -40.65625 C 22.128906 -40.65625 22.363281 -40.550781 22.5625 -40.34375 C 22.769531 -40.144531 22.875 -39.910156 22.875 -39.640625 L 22.875 -7.3125 C 22.875 -4.945312 22.253906 -3.132812 21.015625 -1.875 C 19.773438 -0.625 17.953125 0 15.546875 0 L 9.859375 0 C 7.484375 0 5.671875 -0.625 4.421875 -1.875 C 3.171875 -3.132812 2.546875 -4.945312 2.546875 -7.3125 L 2.546875 -39.640625 C 2.546875 -39.910156 2.644531 -40.144531 2.84375 -40.34375 C 3.050781 -40.550781 3.289062 -40.65625 3.5625 -40.65625 L 8.4375 -40.65625 C 8.707031 -40.65625 8.941406 -40.550781 9.140625 -40.34375 C 9.347656 -40.144531 9.453125 -39.910156 9.453125 -39.640625 L 9.453125 -8.75 C 9.453125 -7.382812 10.128906 -6.703125 11.484375 -6.703125 L 14.125 -6.703125 C 15.476562 -6.703125 16.15625 -7.382812 16.15625 -8.75 L 16.15625 -39.640625 C 16.15625 -39.910156 16.253906 -40.144531 16.453125 -40.34375 C 16.660156 -40.550781 16.90625 -40.65625 17.1875 -40.65625 Z M 17.1875 -40.65625 "
                                        />
                                    </g>
                                </g>
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(161.845254, 325.8768)">
                                    <g>
                                        <path
                                            d="M 2.546875 -0.8125 L 2.546875 -39.84375 C 2.546875 -40.382812 2.816406 -40.65625 3.359375 -40.65625 L 15.546875 -40.65625 C 17.953125 -40.65625 19.773438 -40.03125 21.015625 -38.78125 C 22.253906 -37.53125 22.875 -35.703125 22.875 -33.296875 L 22.875 -7.3125 C 22.875 -4.945312 22.253906 -3.132812 21.015625 -1.875 C 19.773438 -0.625 17.953125 0 15.546875 0 L 3.359375 0 C 2.816406 0 2.546875 -0.269531 2.546875 -0.8125 Z M 9.453125 -6.703125 L 14.125 -6.703125 C 15.476562 -6.703125 16.15625 -7.382812 16.15625 -8.75 L 16.15625 -31.875 C 16.15625 -33.257812 15.476562 -33.953125 14.125 -33.953125 L 9.453125 -33.953125 Z M 9.453125 -6.703125 "
                                        />
                                    </g>
                                </g>
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(188.773143, 325.8768)">
                                    <g>
                                        <path
                                            d="M 2.546875 -7.3125 L 2.546875 -33.34375 C 2.546875 -35.75 3.171875 -37.566406 4.421875 -38.796875 C 5.671875 -40.035156 7.484375 -40.65625 9.859375 -40.65625 L 16.5625 -40.65625 C 18.9375 -40.65625 20.75 -40.035156 22 -38.796875 C 23.257812 -37.566406 23.890625 -35.75 23.890625 -33.34375 L 23.890625 -28.0625 C 23.890625 -27.519531 23.617188 -27.25 23.078125 -27.25 L 18 -27.25 C 17.457031 -27.25 17.1875 -27.519531 17.1875 -28.0625 L 17.1875 -31.921875 C 17.1875 -33.273438 16.503906 -33.953125 15.140625 -33.953125 L 11.484375 -33.953125 C 10.128906 -33.953125 9.453125 -33.273438 9.453125 -31.921875 L 9.453125 -8.75 C 9.453125 -7.382812 10.128906 -6.703125 11.484375 -6.703125 L 15.140625 -6.703125 C 16.503906 -6.703125 17.1875 -7.382812 17.1875 -8.75 L 17.1875 -15.546875 L 14.53125 -15.546875 C 13.988281 -15.546875 13.71875 -15.816406 13.71875 -16.359375 L 13.71875 -21.453125 C 13.71875 -21.992188 13.988281 -22.265625 14.53125 -22.265625 L 23.078125 -22.265625 C 23.617188 -22.265625 23.890625 -21.992188 23.890625 -21.453125 L 23.890625 -7.3125 C 23.890625 -4.945312 23.257812 -3.132812 22 -1.875 C 20.75 -0.625 18.9375 0 16.5625 0 L 9.859375 0 C 7.484375 0 5.671875 -0.625 4.421875 -1.875 C 3.171875 -3.132812 2.546875 -4.945312 2.546875 -7.3125 Z M 2.546875 -7.3125 "
                                        />
                                    </g>
                                </g>
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(216.717106, 325.8768)">
                                    <g>
                                        <path
                                            d="M 22.828125 -39.84375 L 22.828125 -34.765625 C 22.828125 -34.191406 22.554688 -33.90625 22.015625 -33.90625 L 9.296875 -33.90625 L 9.296875 -23.734375 L 19.015625 -23.734375 C 19.554688 -23.734375 19.828125 -23.445312 19.828125 -22.875 L 19.828125 -17.84375 C 19.828125 -17.269531 19.554688 -16.984375 19.015625 -16.984375 L 9.296875 -16.984375 L 9.296875 -6.703125 L 22.015625 -6.703125 C 22.554688 -6.703125 22.828125 -6.429688 22.828125 -5.890625 L 22.828125 -0.8125 C 22.828125 -0.269531 22.554688 0 22.015625 0 L 3.296875 0 C 2.796875 0 2.546875 -0.269531 2.546875 -0.8125 L 2.546875 -39.84375 C 2.546875 -40.382812 2.796875 -40.65625 3.296875 -40.65625 L 22.015625 -40.65625 C 22.554688 -40.65625 22.828125 -40.382812 22.828125 -39.84375 Z M 22.828125 -39.84375 "
                                        />
                                    </g>
                                </g>
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(243.594199, 325.8768)">
                                    <g>
                                        <path
                                            d="M 2.34375 -40.65625 L 21.046875 -40.65625 C 21.585938 -40.65625 21.859375 -40.382812 21.859375 -39.84375 L 21.859375 -34.765625 C 21.859375 -34.222656 21.585938 -33.953125 21.046875 -33.953125 L 15.140625 -33.953125 L 15.140625 -0.8125 C 15.140625 -0.269531 14.867188 0 14.328125 0 L 9.046875 0 C 8.503906 0 8.234375 -0.269531 8.234375 -0.8125 L 8.234375 -33.953125 L 2.34375 -33.953125 C 1.800781 -33.953125 1.53125 -34.222656 1.53125 -34.765625 L 1.53125 -39.84375 C 1.53125 -40.382812 1.800781 -40.65625 2.34375 -40.65625 Z M 2.34375 -40.65625 "
                                        />
                                    </g>
                                </g>
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(125.490291, 366.249657)">
                                    <g>
                                        <path
                                            d="M 11.765625 -9.921875 C 12.460938 -9.804688 13.101562 -9.519531 13.6875 -9.0625 C 14.269531 -8.601562 14.726562 -8.03125 15.0625 -7.34375 C 15.40625 -6.664062 15.578125 -5.941406 15.578125 -5.171875 C 15.578125 -4.191406 15.328125 -3.3125 14.828125 -2.53125 C 14.335938 -1.75 13.617188 -1.128906 12.671875 -0.671875 C 11.722656 -0.222656 10.601562 0 9.3125 0 L 2.125 0 L 2.125 -19.25 L 9.03125 -19.25 C 10.34375 -19.25 11.457031 -19.03125 12.375 -18.59375 C 13.289062 -18.164062 13.976562 -17.582031 14.4375 -16.84375 C 14.90625 -16.113281 15.140625 -15.285156 15.140625 -14.359375 C 15.140625 -13.222656 14.828125 -12.28125 14.203125 -11.53125 C 13.585938 -10.789062 12.773438 -10.253906 11.765625 -9.921875 Z M 4.640625 -10.9375 L 8.875 -10.9375 C 10.050781 -10.9375 10.957031 -11.210938 11.59375 -11.765625 C 12.238281 -12.316406 12.5625 -13.082031 12.5625 -14.0625 C 12.5625 -15.039062 12.238281 -15.804688 11.59375 -16.359375 C 10.957031 -16.910156 10.03125 -17.1875 8.8125 -17.1875 L 4.640625 -17.1875 Z M 9.09375 -2.078125 C 10.34375 -2.078125 11.316406 -2.367188 12.015625 -2.953125 C 12.710938 -3.546875 13.0625 -4.367188 13.0625 -5.421875 C 13.0625 -6.484375 12.691406 -7.320312 11.953125 -7.9375 C 11.222656 -8.5625 10.238281 -8.875 9 -8.875 L 4.640625 -8.875 L 4.640625 -2.078125 Z M 9.09375 -2.078125 "
                                        />
                                    </g>
                                </g>
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(150.718939, 366.249657)">
                                    <g>
                                        <path
                                            d="M 4.578125 -19.25 L 4.578125 -7.078125 C 4.578125 -5.359375 4.992188 -4.082031 5.828125 -3.25 C 6.671875 -2.425781 7.84375 -2.015625 9.34375 -2.015625 C 10.8125 -2.015625 11.960938 -2.425781 12.796875 -3.25 C 13.640625 -4.082031 14.0625 -5.359375 14.0625 -7.078125 L 14.0625 -19.25 L 16.578125 -19.25 L 16.578125 -7.09375 C 16.578125 -5.5 16.253906 -4.148438 15.609375 -3.046875 C 14.960938 -1.953125 14.09375 -1.140625 13 -0.609375 C 11.90625 -0.078125 10.675781 0.1875 9.3125 0.1875 C 7.945312 0.1875 6.71875 -0.078125 5.625 -0.609375 C 4.53125 -1.140625 3.664062 -1.953125 3.03125 -3.046875 C 2.394531 -4.148438 2.078125 -5.5 2.078125 -7.09375 L 2.078125 -19.25 Z M 4.578125 -19.25 "
                                        />
                                    </g>
                                </g>
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(177.660814, 366.249657)">
                                    <g>
                                        <path
                                            d="M 8.125 -19.25 C 10.21875 -19.25 12.035156 -18.859375 13.578125 -18.078125 C 15.117188 -17.296875 16.296875 -16.175781 17.109375 -14.71875 C 17.929688 -13.269531 18.34375 -11.554688 18.34375 -9.578125 C 18.34375 -7.609375 17.929688 -5.898438 17.109375 -4.453125 C 16.296875 -3.015625 15.117188 -1.910156 13.578125 -1.140625 C 12.035156 -0.378906 10.21875 0 8.125 0 L 2.125 0 L 2.125 -19.25 Z M 8.125 -2.078125 C 10.601562 -2.078125 12.5 -2.734375 13.8125 -4.046875 C 15.125 -5.359375 15.78125 -7.203125 15.78125 -9.578125 C 15.78125 -11.972656 15.117188 -13.84375 13.796875 -15.1875 C 12.484375 -16.53125 10.59375 -17.203125 8.125 -17.203125 L 4.640625 -17.203125 L 4.640625 -2.078125 Z M 8.125 -2.078125 "
                                        />
                                    </g>
                                </g>
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(205.486942, 366.249657)">
                                    <g>
                                        <path
                                            d="M 8.125 -19.25 C 10.21875 -19.25 12.035156 -18.859375 13.578125 -18.078125 C 15.117188 -17.296875 16.296875 -16.175781 17.109375 -14.71875 C 17.929688 -13.269531 18.34375 -11.554688 18.34375 -9.578125 C 18.34375 -7.609375 17.929688 -5.898438 17.109375 -4.453125 C 16.296875 -3.015625 15.117188 -1.910156 13.578125 -1.140625 C 12.035156 -0.378906 10.21875 0 8.125 0 L 2.125 0 L 2.125 -19.25 Z M 8.125 -2.078125 C 10.601562 -2.078125 12.5 -2.734375 13.8125 -4.046875 C 15.125 -5.359375 15.78125 -7.203125 15.78125 -9.578125 C 15.78125 -11.972656 15.117188 -13.84375 13.796875 -15.1875 C 12.484375 -16.53125 10.59375 -17.203125 8.125 -17.203125 L 4.640625 -17.203125 L 4.640625 -2.078125 Z M 8.125 -2.078125 "
                                        />
                                    </g>
                                </g>
                            </g>
                            <g fill="var(--primary-color)" fill-opacity="1">
                                <g transform="translate(233.313061, 366.249657)">
                                    <g><path d="M 15.609375 -19.25 L 9.34375 -7.265625 L 9.34375 0 L 6.828125 0 L 6.828125 -7.265625 L 0.53125 -19.25 L 3.3125 -19.25 L 8.0625 -9.5 L 12.8125 -19.25 Z M 15.609375 -19.25 " /></g>
                                </g>
                            </g>
                        </svg>
                        <div class="text-surface-900 dark:text-surface-0 text-3xl font-medium mb-4">Please Register Yourself</div>
                        <span class="text-muted-color font-medium">Register to continue</span>
                        <Message v-if="auth.isValidationError" severity="warn">{{ auth.validationErrors }}</Message>
                    </div>

                    <div>
                        <form @submit.prevent="handleSubmit">
                            <label for="name" class="block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2">Name</label>
                            <InputText id="name" type="text" placeholder="Full Name" class="w-full md:w-[30rem] mb-8" v-model="name" />

                            <label for="email1" class="block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2">Email</label>
                            <InputText id="email1" type="text" placeholder="Email address" class="w-full md:w-[30rem] mb-8" v-model="email" />

                            <label for="password1" class="block text-surface-900 dark:text-surface-0 font-medium text-xl mb-2">Password</label>
                            <Password id="password1" v-model="password" placeholder="Password" :toggleMask="true" class="mb-4" fluid :feedback="false" />

                            <label for="password2" class="block text-surface-900 dark:text-surface-0 font-medium text-xl mb-2">Confirm Password</label>
                            <Password id="password2" v-model="confirmPassword" placeholder="Confirm Password" :toggleMask="true" class="mb-4" fluid :feedback="false" />

                            <p v-if="passwordMismatch" class="text-red-500 text-sm mt-1">Passwords do not match.</p>

                            <Button class="w-full mt-4 mb-4 disabled:opacity-50" :disabled="isFormInvalid" @click="handleSignUp"> Submit </Button>

                            <div class="text-center">
                                <span class="text-muted-color font-medium">Already have an account? </span>
                                <span class="font-semibold no-underline ml-2 text-right cursor-pointer text-primary" @click="handleLogin">Login</span>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<style scoped>
.pi-eye {
    transform: scale(1.6);
    margin-right: 1rem;
}

.pi-eye-slash {
    transform: scale(1.6);
    margin-right: 1rem;
}
</style>
